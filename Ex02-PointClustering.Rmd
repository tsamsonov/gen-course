# Задание №2. Кластеризация системы расселения {#points-clust-work}

__Цель задания__ — освоение методов кластеризации и регионизации точек, построения центроидов и оценки качества кластеризации. В качестве методов кластеризации предлагается использовать DBSCAN, К средних и иерархическую. В качестве метода построения региона — _альфа-оболочку_.

__Исходные данные:__ точки населенных пунктов из Самостоятельной работы №1.

__Используемые библиотеки:__ `geopandas`, [`sklearn.cluster`](https://scikit-learn.org/1.5/modules/clustering.html)

Подсказка по функциям:

- получение координат точек: [get_coordinates()](https://geopandas.org/en/latest/docs/reference/api/geopandas.GeoSeries.get_coordinates.html).
- кластеризация:
  - К-средних: [`KMeans`](https://scikit-learn.org/1.5/modules/generated/sklearn.cluster.KMeans.html#sklearn.cluster.KMeans)
  - Иерархическая: [`AgglomerativeClustering`](https://scikit-learn.org/1.5/modules/generated/sklearn.cluster.AgglomerativeClustering.html#sklearn.cluster.AgglomerativeClustering)
  - DBSCAN: [`DBSCAN`](https://scikit-learn.org/1.5/modules/generated/sklearn.cluster.DBSCAN.html#sklearn.cluster.DBSCAN)
- альфа-оболочка: [`concave_hull`](https://geopandas.org/en/latest/docs/reference/api/geopandas.GeoSeries.concave_hull.html)
- центроиды кластеров: [`representative_point`](https://geopandas.org/en/stable/docs/reference/api/geopandas.GeoSeries.representative_point.html).
- коэффициент силуэта: [`silhouette_score`](https://scikit-learn.org/1.5/modules/generated/sklearn.metrics.silhouette_score.html)

## Кластеризация системы расселения субъекта {-}

1. Трансформируйте исходные данные в проекцию, оптимальную для выбранного региона. 
1. Подготовьте данные для использования в sklearn. Для это необходимо координаты точек выгрузить в `numpy array`.
1. Используя метод _DBSCAN_, постройте серию из 5 кластеризаций населенных пунктов выбранного вами субъекта. Количество точек в кластере оставьте постоянным (3), но меняйте значение расстояния кластеризации. Расстояния подберите таким образом, чтобы различия в кластеризации были очевидны и помогали выявлять пространственные группировки разного масштаба.
1. Используя методы _К-средних_ и _иерархической кластеризации_ (расстояние Уорда), постройте аналогичные серии из 5 кластеризаций. Количество кластеров задавайте то же, что вы получали в методе DBSCAN для соответствующих расстояний. Т.е. если вы в методе DBSCAN для разных расстояний получили 100, 70, 40, 20 и 5 кластеров, то именно столько же надо получить другими методами.
1. Для всех полученных кластеризаций постройте альфа-оболочки кластеров. 
1. Рассчитайте для каждой кластеризации меру качества — коэффициент силуэта. Сведите ее в единую таблицу, где по столбцам идут методы кластеризации, а по строкам — количество кластеров.
1. Для каждого уровня кластеризации и каждого метода подготовьте изображение, включающее: а) исходные точки, б) регионы кластеров, в) центроиды кластеров. Точки и регионы должны быть помечены разными цветами по номерам кластеров. Центроиды должны быть показаны окружностями радиуса, пропорционального количеству входящих точек. 

Пример изображения кластеров:
```{r, out.width = "100%", fig.cap="Пример оформления результатов работы"}
knitr::include_graphics("img/clustering.png")
```

Перед вставкой данных карт в отчет добавьте на них элементы географической основы или используйте карту-подложку из картографического веб-сервиса.

## Отчет {-}

Напишите отчет о проделанной работе, включающий:

1. Цель и задачи работы.
2. Описание используемых алгоритмов кластеризации и регионизации.
3. Описание процесса создания скриптов для решения поставленных задач.
4. Серию из 15 карт кластерной структуры системы расселения региона, полученную по результатам кластеризации тремя алгоритмами (по 5 изображений на каждый метод).
5. Анализ качества кластеризации (согласно коэффцициенту силуэта).
6. Географический анализ результатов. Насколько реалистично выглядят кластеры, полученные разными методами к чему они привязаны? Можно ли выявить полимасштабность организации системы расселения на основе полученных изображений?