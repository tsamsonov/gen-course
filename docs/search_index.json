[
["index.html", "Картографические базы данных Генерализация пространственных данных Введение", " Картографические базы данных Генерализация пространственных данных Тимофей Самсонов 2019-10-14 Введение Картографические базы данных "],
["points.html", "Глава 1 Генерализация точечных объектов 1.1 Отбор 1.2 Кластеризация и регионизация", " Глава 1 Генерализация точечных объектов 1.1 Отбор 1.1.1 Краткий обзор Для просмотра презентации щелкните на ней один раз левой кнопкой мыши и листайте, используя кнопки на клавиатуре: Презентацию можно открыть в отдельном окне или вкладке браузере. Для этого щелкните по ней правой кнопкой мыши и выберите соответствующую команду. 1.1.2 Самостоятельная работа №1 Цель задания — освоение методики автоматизированного отбора точечных объектов на примере населенных пунктов. Задачи: Изучить принципы, заложенные в метод отбора (исключения) точек Settlement Spacing. Реализовать метод Settlement Spacing в среде ArcGIS Desktop с помощью среды автоматизации процессов геообработки Model Builder. Реализовать метод оценки графической нагрузки по сетке регулярных квадратов средствами Model Builder. Подготовить слой населенных пунктов субъекта РФ на основе данных OpenStreetMap. Осуществить автоматизированный отбор населенных пунктов для масштаба \\(1:4~000~000\\). Произвести графическую оценку результатов генерализации. Реализация алгоритма Settlement Spacing Входные параметры: Точечный слой (Input Points). Поле веса точки (Importance Field). Выносится в качестве параметра из инструмента Get Field Value (2.2). Поле сохранения точки (Remain Field). Выносится в качестве параметра из инструмента Calculate Field (6). Масштабирующий коэффициент (Scale). Вводится как свободный параметр типа Double. Требования к входным параметрам: Поля, указанные в параметрах Importance Field и Remain Field должны быть уже созданы в слое. Данные должны быть физически отсортированы в порядке увеличения поля Importance (чем больше значение этого поля, тем менее важной является точка). Для этого можно использовать инструмент Sort. Поле Remain по умолчанию должно быть пустым или заполненным нулями. Допустимые значения поля Remain: \\(0\\) — флаг не установлен. \\(1\\) — точку необходимо оставить. \\(2\\) — точку необходимо убрать. Предусловия: Необходимо расставить предусловия таким образом, чтобы каждый инструмент A, использующий вычисленное значение B, выполнялся после того как вычислится B. Входные данные: Тестирование инструмента производится на примере слоя poppnt_ural (можно вырезать из него небольшой фрагмент из нескольких десятков точек. Результат: По результатам выполнения инструмента каждой точке в поле Remain Field должно быть проставлено значение \\(1\\) (оставить) или \\(2\\) (убрать). Алгоритм решения задачи: Поток 1 1.1. Создать слой из точек (Make Feature Layer) 1.2. Выбрать точки (уже отобранные + текущая) по атрибутам (Select Layer by Attributes). Подсказка: используйте двойное условие, в котором поле Remain сравнивается с \\(1\\), а поле OBJECTID сравнивается со значением Value, полученным на шаге 2.1. Поток 2 2.1. Выбрать текущую точку с помощью итератора (Iterate Feature Selection) 2.2. Извлечь значение поля Importance (Get Field Value) 2.3. Вычислить радиус буферной зоны (Calculate Value) как произведение Importance (2.2) и входного параметра Scale. 2.4. Построить буферную зону, используя вычисленное значение 2.3 (Buffer) Довыбрать (SUBSET_SELECTION) буферной зоной (2.4) отобранные точки + текущую (1.2) с помощью пространственного запроса (Select Layer by Location). &gt; Внимание: в результате должны остаться только те точки, которые пересекаются буферной зоной! Подсчитать количество отобранных на шаге 3 точек (Get Count) Вычислить значение флага отбора точек, используя результат шага 4 (Calculate Value). Если выборка содержит 1 точку, то значение флага должно быть равно 1, если больше точек, то оно должно быть равно 2. Подсказка: тип выходного поля сделайте равным Long, но для вычисления используйте логическое выражение, результатом которого будет являться Ложь (0) или Истина (1). Вычислите поле Remain для текущей точки (2.1), используя значение флага отбора, полученное на шаге 5 (Calculate Field). Реализация модели оценки условной графической нагрузки Условная графическая нагрузка – средневзвешенное количество точек на единицу площади, где в качестве веса выступает размер точки, используемый при ее отображении на карте Входные параметры: Точечный слой Поле Size Field, отвечающее за графический вес точки (диаметр значка). Пространственное разрешение сетки (в метрах) Требования к входным данным: Поле Size Field должно содержать размеры значков, используемых для визуализации точек. Если значения всех размеров равны \\(1\\), вы получите обычную густоту точек на единицу площади. Необходимо самостоятельно реализовать модель геообработки, которая: Строит регулярную сетку с заданным разрешением и охватом, покрывающим входной набор точек с небольшим запасом. Подсказка: вам необходимо построить горизонтальный ограничивающий прямоугольник (Minimum Bounding Geometry), буферизовать его на величину разрешения сетки (Buffer) и подать буфер в качестве экстента в инструмент генерации регулярной сетки (Create Fishnet). Подсчитывает суммарный графический вес точек в каждой ячейке и записывает результат в новое поле. Подсказка: вам понадобятся инструменты статистики (Tabulate Intersection), и присоединения поля (Join Field). Сохраняет полученную сетку в выходной файл. Отбор населенных пунктов для карты масштаба 1:4 000 000 В данной — заключительной — части задания необходимо произвести отбор населенных пунктов, используя собственные модели геообработки, а также произвести графическую оценку полученных результатов. Алгоритм выполнения задания: Скачать данные OSM на территорию Субъекта Федерации Перепроецировать слой settlement-points в наилучшую проекцию для выбранной территории Сформировать поля Importance и Size, используя следующее отображение атрибутов: Таблица 1.1: Параметры заполнения полей PLACE Importance Size City 1 5 Town 2 3 Village 3 1 Hamlet 4 1 Locality 5 1 Используя фрагмент данных и значения параметра Scale в диапазоне от \\(1000\\) до \\(10000\\) с шагом \\(1000\\), подобрать регрессионную зависимость между значением параметра масштабирования Scale и средней графической нагрузкой (\\(ед.~на~см^2\\)) в масштабе \\(1:4~000~000\\). Средняя графическая нагрузка оценивается как среднее значение по всем ненулевым ячейкам регулярной сетки. Размер сетки — \\(1~см^2\\) в результирующем масштабе. Выполнить отбор населенных пунктов с графической нагрузкой \\(1\\), \\(3\\) и \\(5\\) населенных пункта на \\(см^2\\) для масштаба \\(1:4~000~000\\). Соответствующий параметр Scale подберите, используя найденную регрессионную зависимость. Оформить результаты в виде картосхемы, отображающей: границу региона множество исходных точек бледно-серым цветом множество отобранных точек черным цветом соответствующего размера подписи основных населенных пунктов картограмму условной графической нагрузки Рис. 1.1: Пример оформления результатов работы Отчет Работа оформляется в виде письменного отчета, в котором необходимо изложить все этапы исследования: цель и задачи исследования, суть метода отбора точек, суть принципа оценки графической нагрузки, этапы создания моделей геообработки и их внешний вид, описание эксперимента по генерализации, включая постановку задачи, нахождение регрессионной зависимости, выполнение отбора. 1.2 Кластеризация и регионизация 1.2.1 Краткий обзор Для просмотра презентации щелкните на ней один раз левой кнопкой мыши и листайте, используя кнопки на клавиатуре: Презентацию можно открыть в отдельном окне или вкладке браузере. Для этого щелкните по ней правой кнопкой мыши и выберите соответствующую команду. 1.2.2 Самостоятельная работа №2 Цель задания — освоение методов кластеризации и регионизации точек, а также построения центроидов. В качестве метода кластеризации предлагается использовать DBSCAN. В качестве метода построения региона — альфа-оболочку. Исходные данные: точки населенных пунктов из Самостоятельной работы №1. Изучение работы методов кластеризации и регионизации На данном этапе необходимо изучить принципы работы метода кластеризации DBSCAN, построения альфа-оболочки и центроида полигона: Метод DBSCAN доступен в виде инструмента Python, приложенного к данному заданию. Метод альфа-оболочки доступен в инструменте Cartography Tools &gt; Generalization &gt; Aggregate Points. Центроид полигона можно получить посредством применения инструмента Data Management Tools &gt; Features &gt; Feature to Polygon. Меняя параметры инструментов (расстояния, количество точек), ознакомьтесь с тем, как это влияет на получаемый результат. Оболочки, как и кластеры стройте для набора данных test. Автоматизация выделения регионов и центроидов кластеров Необходимо создать модель геообработки, которая будет принимать на вход слой маркированных точек и выдавать класс пространственных объектов с альфа-оболочками каждого кластера, а также центроидами кластеров Параметры инструмента: Входной слой точек (Input points) Название поля, в котором хранятся марки кластеров (Cluster ID Field) Расстояние кластеризации (Сluster distance) Выходной слой альфа-оболочек (Output regions feature class) Выходной слой центроидов (Output centroids feature class) Требования к результатам: Каждый регион должен соответствовать своему кластеру и содержать в качестве атрибутов исходный идентификатор и количество точек, входящих в данный кластер. Центроиды кластеров должны быть получены методом Inside (внутри) Рекомендации по выполнению: Инструмент должен состоять из двух моделей. Первая модель принимает на вход все параметры и создает пустой полигональный класс пространственных объектов для добавления альфа-оболочек кластеров. Это класс вместе со всеми исходными параметрами передается в другую модель, которая будет наполнять его оболочками для каждого кластера. Для прохода по номерам кластеров используйте итератор типа Iterate Field Values в режиме Unique Values (уникальные значения). Сделайте так, чтобы на выходе не создавались кластеры для точек-выбросов (идентификатор -1). Для полученных регионов кластеров необходимо выполнить операцию объединения Dissolve, так как они могут состоять из нескольких оболочек, касающихся в одной точке. В качестве расстояния кластеризации необходимо указывать удвоенное расстояние, использованное ранее в методе DBSCAN. В этом случае оболочки будут соответствовать исходным кластерам. Кластеризация системы расселения субъекта Cроецируйте исходные данные в проекцию, оптимальную для выбранного региона. Используя созданный инструмент, постройте серию из 5 кластеризаций населенных пунктов выбранного вами субъекта. Количество точек в кластере оставьте постоянным (3), но меняйте значение расстояния кластеризации. Расстояния подберите таким образом, чтобы различия в кластеризации были очевидны и помогали выявлять пространственные группировки разного масштаба. Рассчитайте для каждой кластеризации меры качества: среднее внутрикластерное и межкластерное расстояние, их отношение. Сведите их в таблицу. Для каждого уровня кластеризации подготовьте изображение, включающее: а) исходные точки, б) регионы кластеров, в) центроиды кластеров. Точки и регионы должны быть помечены разными цветами по номерам кластеров. Центроиды должны быть показаны окружностями радиуса, пропорционального количеству входящих точек. Пример изображения кластеров: Рис. 1.2: Пример оформления результатов работы Перед вставкой данных карт в отчет добавьте на них элементы географической основы или используйте карту-подложку в виде картографического веб-сервиса. Отчет Напишите отчет о проделанной работе, включающий: Цель и задачи работы. Описание алгоритмов DBSCAN, построения альфа-оболочки и центроида полигона. Описание процесса создания моделей геообработки для выделения регионов и центроидов кластеров. Серию из 5 карт кластерной структуры системы расселения региона, полученную по результатам кластеризации. Анализ качества кластеризации (согласно рассчитанным критериям). Географический анализ результатов. Насколько реалистично выглядят полученные кластеры, к чему они привязаны? Можно ли выявить полимасштабность организации системы расселения на основе полученных изображений? "],
["lines.html", "Глава 2 Генерализация линейных объектов 2.1 Геометрическое упрощение", " Глава 2 Генерализация линейных объектов 2.1 Геометрическое упрощение 2.1.1 Краткий обзор Для просмотра презентации щелкните на ней один раз левой кнопкой мыши и листайте, используя кнопки на клавиатуре: Презентацию можно открыть в отдельном окне или вкладке браузере. Для этого щелкните по ней правой кнопкой мыши и выберите соответствующую команду. 2.1.2 Самостоятельная работа №3 (Автоматизация геометрического упрощения линий) Введение Цель задания — освоение методики геометрического упрощения линий. Аннотация. Необходимо реализовать метод Ли-Оупеншоу для генерализации линий. Для этого в среде Model Builder создается модель геообработки, осуществляющая последовательный запуск инструментов ArcToolbox. После создания инструмента необходимо сравнить результаты работы алгоритма с тем, что получается при обработке линий посредством алгоритма Дугласа-Пейкера, Ванга-Мюллера и Висвалингам-Уайатта. Задание выполняется в ГИС-пакете ArcGIS 10.5. Алгоритм Ли-Оупеншоу \\[2\\] использует «естественный принцип», суть которого заключается в удалении деталей, размер которых менее видимой величины. Для этого на исходное множество линий накладывается регулярная сет ка ячеек с разрешением d Участок линии, пересекающий ячейку, имеет точку входа в нее и точку выхода. Этот участок заменяется на середину отрезка, соединяющего две данные точки. Таким образом, удаляются все изгибы, находящиеся внутри ячеек. Принцип работы алгоритма иллюстрирует Рис. ??. Видно, что по своему поведению результирующая линия похожа на скользящее среднее. Рис. 2.1: Принцип работы алгоритма Ли-Оупеншоу В основе работы алгоритма Ванга-Мюллера \\[4\\] лежит сегментация линий на отдельные изгибы. Изгиб определяется как участок линии, на котором угол ее поворота сохраняет свой знак. Важным аспектом алгоритма является четкий алгоритм вычисления вершины изгиба, которая определяется как точка, имеющая максимальную сумму расстояний до начальной и конечной точки изгиба. Для каждого изгиба в алгоритме Ванга-Мюллера определяется его размер, изолированность, близость и схожесть с соседним изгибом. Изолированные изгибы подвергаются преувеличению. Расположенные рядом схожие изгибы объединяются в один путем слияния вершин и удаления изгиба между ними. Наконец, изгибы малого размера удаляются. Данные операции проиллюстрированы на Рис. ??. В ArcGIS метод Ванга-Мюллера реализован в инструменте Simplify Line (режим BEND_SIMPLIFY). Рис. 2.2: Элементы алгоритма Ванга-Мюллера: а) удаление; б) объединение; в) преувеличение изгибов Алгоритм Дугласа-Пейкера \\[1\\] относится к алгоритмам редуцирования точек и основан на последовательном нахождении узлов линии, образующих максимальное отклонение от стягивающей хорды (Рис. ??). В ArcGIS метод Дугласа-Пейкера реализован в инструменте Simplify Line (режим POINT_REMOVE). Рис. 2.3: Принцип работы алгоритма Дугласа-Пейкера Наконец, алгоритм Висвалингам-Уайатта \\[3\\] относится к алгоритмам редуцирования точек и основан на последовательном удалении точек, углы которых образуют минимальную эффективную площадь (Рис. ??). В ArcGIS данный алгоритм представлен в модификации Жу и Джонса \\[5\\], где каждая площадь приобретает различный вес в зависимости от пропорций угла линии и реализован в инструменте Simplify Line (режим WEIGHTED_AREA). Рис. 2.4: Принцип работы алгоритма Висвалингам-Уайатта Библиография: Douglas D. H., Peucker T. K. Algorithms for the reduction of the number of points required to represent a digitized line or its caricature. // The Canadian Cartographer, 10 (2), 1973, pp. 112–122. Li Z., Openshaw S. Algorithms for Automated Line Generalization Based on a Natural Principle of Objective Generalization // International Journal of Geographic Information Systems, 1992, 6,5, pp. 373-389. Visvalingam, M. and Whyatt, J.D., 1993, Line generalisation by repeated elimination of points. Cartographic Journal, 30(1), 46-51. Wang Z., Muller J.-C. Line Generalization Based on Analysis of Shape Characteristics // Cartography and Geographic Information Systems, 25, 1998, pp. 3-15. Zhou S., Jones C.B. Shape-Aware Line Generalisation With Weighted Effective Area. In: Developments in Spatial Data Handling. Springer, Berlin, Heidelberg, 2005. DOI: 10.1007/3-540-26772-7_28 Часть 1. Автоматизация метода Ли-Оупеншоу Создайте базу геоданных для результатов генерализации и назначьте ее базой данных по умолчанию для размещения результатов пространственного анализа. Проделайте следующую последовательность операций (жирным шрифтом указаны названия инструментов): Постройте вокруг исходных линий буфер (Buffer), размер которого равен разрешению генерализации (3000 м). В качестве исходных линий используйте слой Island в базе геоданных Test. Создать сетку (Create Fishnet). В качестве образца экстента используйте полученный буфер. Для тестирования используйте размер сетки 3000 м. Тип сетки должен быть полигональный. Найти пересечение сетки и исходных линий (Identity). Cлоем источника должен быть слой генерализуемых линий. Слоем Identity — сетка. Превратить линии из составных в обычные (Multipart to Singlepart). Найти точки линий, лежащие на границах ячеек (Feature Vertices to Points, режим BOTH_ENDS). Восстановить отрезки, соединяющие эти точки (Points to Line), используя идентификатор отрезка (ORIG_FID). Найти середины отрезков, полученных на шаге e) (Feature Vertices to Points, режим MIDPOINT). Восстановить линию из отрезков, полученных на шаге е) (Unsplit Line). Разрезать эту линию серединами, полученными на шаге f) (Split Line At Point, допуск по расстоянию 100 м). Превратить разрезанные линии из составных в обычные (Multipart to Singlepart). Найти конечные точки полученных сегментов линий (Feature Vertices to Points, режим BOTH_ENDS). Восстановить отрезки, соединяющие эти точки (Points to Line), используя идентификатор отрезка ORIG_FID. Восстановить линию из отрезков (Unsplit Line). Примечание: шаги g) – j) нужны для того, чтобы середины соседних отрезков, полученные на шаге f) приобрели общий идентификатор для их соединения. Создайте модель геообработки “LiOpenshaw Line Simplification”. Реализуйте последовательность действий, выполненную на шаге 2, в виде модели геообработки LiOpenshaw. Вынесите в качестве параметров модели следующие объекты: Входной слой линий Разрешение сетки по X Разрешение сетки по Y Экстент сетки Выходной слой линий Убедитесь, что для остальных параметров в модели стоит опция Intermediate (промежуточный). Протестируйте инструмент на слое Island, используя разное разрешение (2-10 км) Изложите ваш опыт создания инструмента в отчете, включая краткое описание среды Model Builder, интерпретацию метода Ли-Оупеншоу в терминах инструмента геообработки, процесс создания модели и оформления ее параметров. Проиллюстрируйте текст снимками экрана. Часть 2. Автоматизация методов оценки геометрической точности и коэффициента относительной извилистости Автоматизация вычисления модифицрованного Хаусдорфова расстояния MHD (оценка геометрической точности) Модель Modified Hausdorff Distance должна включать следующие этапы. Конвертируйте исходную линию в точки (Feature vertices to points). Добавьте в таблицу поле ID, запишите в него значение OBJECTID (Add Field, Calculate Field) Добавьте в таблицу поле Sort, запишите в него значение 0 (Add Field, Calculate Field). Это будут начальные точки векторов смещения. Вычислите расстояние от полученных точек до генерализованной линии (Near, с установленной опцией Location). Помимо расстояний, полученный слой будет содержать также координаты ближайшей точки. Конвертируйте таблицу в точечный слой на основе полученных координат (Make XY Event Layer). Это будут конечные точки векторов смещения. Замените значения поля Sort в полученном слое на 1 (Calculate Field). Добавьте содержимое полученного слоя к точечному классу, содержащему исходные точки (Append). Конвертируйте полученные точки в линии векторов смещения (Points to Line). В качестве Line Field используйте поле ID, в качестве Sort Field – поле Sort. Визуализируйте полученный слой стрелками как на Рис. ??. Рис. 2.5: Пример визуализации векторов смещения линии Чтобы символика присваивалась автоматически по результатам выполнения модели геообработки, необходимо заготовить файл *.lyr и положить его в туже папку, что и ваша модель. Далее в свойствах итогового класса объектов в Model Builder укажите созданный файл на вкладке Layer Symbology. Вычислите среднее расстояние от исходной линии до генерализованной путем осреднения поля Shape_Length (Summary Statistics) Вычислите аналогичным образом обратное расстояние (для этого потребуется генерализованную линию превратить в точки). Получите Модифицированное Хаусдорфово расстояние путем нахождения максимума из полученных значений (Calculate Value). Чтобы извлечь значения, используйте функцию Get Field Value. Модель должна включать следующие параметры: Исходные линии Генерализованные линии Выходной класс векторов смещения Автоматизация вычисления коэффициента относительной извилистости (оценка морфологического соответствия) Создайте новую модель геообработки Sinuosity, модифицировав модель генерализации, созданную ранее для алгоритма Ли-Оупеншоу. Вам необходимо внутри каждого квадрата поделить длину исходной линии на длину отрезка, соединяющего точки пересечения с линиями сетки. А затем посчитать среднее из полученных значений (Summary Statistics). 2.1.2.0.1 Отчет. Опишите ваш опыт разработки моделей оценки геометрической точности морфологического соответствия для линий. Сопроводите данный раздел отчета снимками экрана и примерами получаемых результатов. Часть 3. Сравнение алгоритмов Ли-Оупеншоу, Ванга-Мюллера, Дугласа-Пейкера и Висвалингам-Уайатта Сравните результаты работы вашей модели и инструмента Simplify Line в режимах BEND_SIMPLIFY (алгоритм Ванга-Мюллера), POINT_REMOVE (алгоритм Дугласа-Пейкера) и WEIGHTED_AREA (алгоритм Висвалингам-Уайатта). Используя шаг сетки, равный 2 мм в результирующем масштабе (1:4 000 000), упростите линию с помощью метода Ли-Оупеншоу. Подберите параметры алгоритмов Дугласа-Пейкера, Ванга-Мюллера и Висвалингам-Уайатта таким образом, чтобы количество результирующих точек в линиях было примерно равно (±5%) количеству точек после генерализации методом Ли-Оупеншоу. Выпишите эти параметры в отчет. Для подсчета количества точек используйте инструмент Feature Vertices to Points Рассчитайте модифицированное Хаусдорфово расстояние от оригинальной линии для четырех полученных результатов генерализации Рассчитайте коэффициент относительной извилистости в исходном и результирующем масштабе, используя шаг сетки 5-7 мм в масштабе карты. Сведите в одну таблицу параметры инструментов, а также рассчитанные величины MHD и коэффициента относительной извилистости по каждому алгоритму. Оцените алгоритмы по следующим критериям: При каких параметрах инструментов количество результирующих узлов линий одинаково? Хаусдорфово расстояние. Насколько эффективно алгоритм использует точки? Какой из алгоритмов дает контур, наиболее близко повторяющий исходную кривую? Относительная извилистость. Насколько сглаженным/угловатым получается изображение? Какой из алгоритмов дает значение извилистости более близкое к оригиналу? Какой метод на ваш взгляд дает наиболее удовлетворительные результаты с точки зрения принципов картографической генерализации и лучше передает морфологию объектов? Сделайте для отчета 4 иллюстрации с мини-легендой, на каждой из которых показан исходный контур и поверх — его генерализованная версия (по иллюстрации на каждый алгоритм). Разные алгоритмы выделите разными цветами. Изложите в отчете свой опыт сравнительного анализа алгоритмов генерализации. "]
]
